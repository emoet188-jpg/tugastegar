<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Daftar Harga Barang - JTIK</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    /* Visual-only theme to match main site (dark, modern) */
    :root{--accent:#ff6b6b;--card-bg:rgba(255,255,255,0.02);--muted:#98a0ad}
    html,body{height:100%;background:radial-gradient(900px 400px at 10% 10%, rgba(255,107,107,0.04), transparent 6%), #0f1724;color:#e6eef8;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;margin:0}
    .container{max-width:1100px}

    /* preserve navbar shape but match colors */
    .navbar { background: linear-gradient(180deg, rgba(200,35,51,0.12), rgba(200,35,51,0.06)); backdrop-filter: blur(6px); border-bottom:1px solid rgba(255,255,255,0.03); }
    .navbar .navbar-brand{color:#fff}
    .navbar .nav-link{color:rgba(230,238,248,0.85)}
    .navbar .nav-link.active{color:var(--accent);font-weight:600}

    .card{background:linear-gradient(180deg,var(--card-bg),rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03);border-radius:12px}
    .card-header.brand{background:linear-gradient(90deg,rgba(255,107,107,0.12),rgba(255,255,255,0.02));color:#fff;font-weight:700;padding:.9rem}
    .card-body{color:#dbe9ff;padding:1rem}

    /* table visuals */
    .table thead th{background:rgba(255,255,255,0.02);color:#fff;border-bottom:1px solid rgba(255,255,255,0.03);position:sticky;top:0}
    .table td,.table th{border-color:rgba(255,255,255,0.03);vertical-align:middle}
    .table tbody tr:hover{background:rgba(255,255,255,0.02)}

    /* form inputs */
    .form-control{background:rgba(255,255,255,0.015);border:1px solid rgba(255,255,255,0.03);color:#e6eef8}
    .form-select{background:rgba(255,255,255,0.015);border:1px solid rgba(255,255,255,0.03);color:#e6eef8}

    footer{border-top:1px solid rgba(255,255,255,0.02);background:linear-gradient(180deg,rgba(0,0,0,0.03),transparent);padding:.9rem 0;color:var(--muted)}

    .accent-pill{display:inline-block;padding:.25rem .6rem;background:linear-gradient(90deg,var(--accent),#ff8a8a);color:#fff;border-radius:999px;font-weight:600}

    @media (max-width:767px){.container{padding:1rem}}
  </style>
</head>
<body>
  <!-- Navbar: shape preserved per request -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-danger shadow-sm sticky-top">
    <div class="container">
      <a class="navbar-brand fw-bold" href="home.html">Beranda</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="nav-link" href="index.html">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="artikel.html">About</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="bukutamu.html">Buku Tamu</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="#">Daftar Harga</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <main class="container my-5">
    <div class="card shadow-sm">
      <header class="card-header brand d-flex justify-content-between align-items-center">
        <div>
          <h4 class="mb-0">Daftar Harga Barang</h4>
          <div class="small text-muted" style="opacity:.7">Harga ditampilkan dalam Rupiah (Rp)</div>
        </div>
        <div class="d-flex align-items-center gap-2">
          <input id="search" class="form-control form-control-sm" placeholder="Cari nama barang..." style="min-width:200px">
          <button id="exportCsv" class="btn btn-outline-light btn-sm" title="Export CSV"><i class="bi bi-download"></i> CSV</button>
        </div>
      </header>
      <div class="card-body">
        <div class="table-responsive">
          <table id="priceTable" class="table table-bordered table-hover align-middle text-center mb-0">
            <thead class="table-light">
              <tr>
                <th scope="col">#</th>
                <th scope="col">Nama Barang</th>
                <th scope="col">Harga (Rp)</th>
                <th scope="col">Kuantitas</th>
                <th scope="col">Satuan</th>
                <th scope="col">Subtotal (Rp)</th>
                <th scope="col">Aksi</th>
              </tr>
            </thead>
            <tbody>
              <!-- Data akan terisi oleh JS -->
            </tbody>
            <tfoot>
              <tr>
                <th colspan="5" class="text-end">Total</th>
                <th id="grandTotal">Rp 0</th>
                <th></th>
              </tr>
            </tfoot>
          </table>
        </div>

        <hr class="my-3">
        <form id="addForm" class="row g-2 align-items-end">
          <div class="col-sm-4">
            <label class="form-label small mb-1">Nama Barang</label>
            <input id="itemName" class="form-control form-control-sm" required>
          </div>
          <div class="col-sm-2">
            <label class="form-label small mb-1">Harga (Rp)</label>
            <input id="itemPrice" class="form-control form-control-sm" inputmode="numeric" required>
          </div>
          <div class="col-sm-2">
            <label class="form-label small mb-1">Kuantitas</label>
            <input id="itemQty" class="form-control form-control-sm" type="number" min="1" value="1" required>
          </div>
          <div class="col-sm-2">
            <label class="form-label small mb-1">Satuan</label>
            <select id="itemUnit" class="form-select form-select-sm">
              <option>pcs</option>
              <option>pack</option>
              <option>lusin</option>
              <option>rim</option>
            </select>
          </div>
          <div class="col-sm-2 text-end">
            <button class="btn btn-danger btn-sm" type="submit"><i class="bi bi-plus-lg"></i> Tambah</button>
          </div>
        </form>
      </div>
    </div>

    <div class="mt-3 small text-muted">Catatan: perubahan tersimpan secara lokal di browser (localStorage).</div>
  </main>

  <footer class="bg-white border-top py-3 mt-5">
    <div class="container d-flex justify-content-between small text-muted">
      <div>JTIK UNM</div>
      <div>&copy; 2025</div>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Utility
    const formatRp = v => 'Rp ' + Number(v).toLocaleString('id-ID');

    // Initial data (converted from original file)
    const defaultItems = [
      {name:'Buku', price:5000, qty:100, unit:'lusin'},
      {name:'Kertas A4', price:40000, qty:100, unit:'pack'},
      {name:'Pulpen', price:4000, qty:50, unit:'pack'}
    ];

    // State
    const storageKey = 'jtik_price_list';
    let items = JSON.parse(localStorage.getItem(storageKey) || 'null') || defaultItems;

    // DOM
    const tbody = document.querySelector('#priceTable tbody');
    const grandTotalEl = document.getElementById('grandTotal');
    const addForm = document.getElementById('addForm');
    const search = document.getElementById('search');
    const exportCsv = document.getElementById('exportCsv');

    function save(){ localStorage.setItem(storageKey, JSON.stringify(items)); }

    function render(filter=''){
      tbody.innerHTML = '';
      let total = 0;
      items.forEach((it, i)=>{
        if(filter && !it.name.toLowerCase().includes(filter.toLowerCase())) return;
        const subtotal = it.price * it.qty;
        total += subtotal;
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${i+1}</td>
          <td class="text-start">${it.name}</td>
          <td>${formatRp(it.price)}</td>
          <td>${it.qty}</td>
          <td>${it.unit}</td>
          <td>${formatRp(subtotal)}</td>
          <td>
            <button class="btn btn-sm btn-outline-primary me-1" data-action="edit" data-index="${i}"><i class="bi bi-pencil-square"></i></button>
            <button class="btn btn-sm btn-outline-danger" data-action="delete" data-index="${i}"><i class="bi bi-trash"></i></button>
          </td>
        `;
        tbody.appendChild(tr);
      });
      grandTotalEl.textContent = formatRp(total);
    }

    // Initial render
    render();

    // Add item
    addForm.addEventListener('submit', e=>{
      e.preventDefault();
      const name = document.getElementById('itemName').value.trim();
      const price = Number(document.getElementById('itemPrice').value.replace(/[^0-9]/g,''));
      const qty = Number(document.getElementById('itemQty').value);
      const unit = document.getElementById('itemUnit').value;
      if(!name || !price || !qty) return;
      items.unshift({name,price,qty,unit});
      save(); render(search.value);
      addForm.reset(); document.getElementById('itemQty').value = 1;
    });

    // Table actions (edit, delete)
    tbody.addEventListener('click', e=>{
      const btn = e.target.closest('button'); if(!btn) return;
      const action = btn.dataset.action; const idx = Number(btn.dataset.index);
      if(action === 'delete'){
        if(confirm('Hapus item ini?')){ items.splice(idx,1); save(); render(search.value); }
      } else if(action === 'edit'){
        const it = items[idx];
        const newName = prompt('Nama Barang', it.name); if(newName===null) return;
        const newPrice = prompt('Harga (Rp)', it.price); if(newPrice===null) return;
        const newQty = prompt('Kuantitas', it.qty); if(newQty===null) return;
        items[idx] = {name:newName, price:Number(newPrice), qty:Number(newQty), unit:it.unit};
        save(); render(search.value);
      }
    });

    // Search
    search.addEventListener('input', e=> render(e.target.value));

    // Export CSV
    function toCsv(rows){
      const header = ['Nama Barang','Harga','Kuantitas','Satuan','Subtotal'];
      const lines = [header.join(',')];
      rows.forEach(r=>{
        lines.push([`"${r.name}"`, r.price, r.qty, r.unit, r.price * r.qty].join(','));
      });
      return lines.join('\n');
    }
    exportCsv.addEventListener('click', ()=>{
      const csv = toCsv(items);
      const blob = new Blob([csv], {type:'text/csv'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = 'daftar_harga_jtik.csv'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    });

    // Allow numeric input formatting for price field
    const priceInput = document.getElementById('itemPrice');
    priceInput.addEventListener('input', e=>{
      const v = e.target.value.replace(/[^0-9]/g,'');
      e.target.value = v ? Number(v).toLocaleString('id-ID') : '';
    });

  </script>
</body>
</html>